[2024-06-03 15:06:16,817] 181 apscheduler.scheduler - INFO -Scheduler started
[2024-06-03 15:06:25,142] 22 root - INFO -starting data ingestion
[2024-06-03 15:06:25,142] 27 root - INFO -Exporting data from casandra to feature store 
[2024-06-03 15:06:27,153] 1703 cassandra.cluster - WARNING -Downgrading core protocol version from 66 to 65 for e4d5a3c1-e93d-4762-b366-9ba2252f22f5-eu-west-1.db.astra.datastax.com:29042:190dafab-6970-3a67-a21c-1226360de7dc. To avoid this, it is best practice to explicitly set Cluster(protocol_version) to the version supported by your cluster. http://datastax.github.io/python-driver/api/cassandra/cluster.html#cassandra.cluster.Cluster.protocol_version
[2024-06-03 15:06:28,507] 1703 cassandra.cluster - WARNING -Downgrading core protocol version from 65 to 5 for e4d5a3c1-e93d-4762-b366-9ba2252f22f5-eu-west-1.db.astra.datastax.com:29042:190dafab-6970-3a67-a21c-1226360de7dc. To avoid this, it is best practice to explicitly set Cluster(protocol_version) to the version supported by your cluster. http://datastax.github.io/python-driver/api/cassandra/cluster.html#cassandra.cluster.Cluster.protocol_version
[2024-06-03 15:06:30,095] 1703 cassandra.cluster - WARNING -Downgrading core protocol version from 5 to 4 for e4d5a3c1-e93d-4762-b366-9ba2252f22f5-eu-west-1.db.astra.datastax.com:29042:190dafab-6970-3a67-a21c-1226360de7dc. To avoid this, it is best practice to explicitly set Cluster(protocol_version) to the version supported by your cluster. http://datastax.github.io/python-driver/api/cassandra/cluster.html#cassandra.cluster.Cluster.protocol_version
[2024-06-03 15:06:32,989] 292 cassandra.policies - INFO -Using datacenter 'eu-west-1' for DCAwareRoundRobinPolicy (via host 'e4d5a3c1-e93d-4762-b366-9ba2252f22f5-eu-west-1.db.astra.datastax.com:29042:190dafab-6970-3a67-a21c-1226360de7dc'); if incorrect, please specify a local_dc to the constructor, or limit contact points to local cluster nodes
[2024-06-03 15:06:32,990] 3863 cassandra.cluster - WARNING -Found multiple hosts with the same endpoint (e4d5a3c1-e93d-4762-b366-9ba2252f22f5-eu-west-1.db.astra.datastax.com:29042:190dafab-6970-3a67-a21c-1226360de7dc). Excluding peer 10.0.0.1
[2024-06-03 15:06:32,995] 2126 cassandra.cluster - INFO -Cassandra host e4d5a3c1-e93d-4762-b366-9ba2252f22f5-eu-west-1.db.astra.datastax.com:29042:00694036-11ec-39fb-8238-d79afd9b0e46 removed
[2024-06-03 15:06:41,511] 3244 cassandra.cluster - WARNING -Failed to create connection pool for new host e4d5a3c1-e93d-4762-b366-9ba2252f22f5-eu-west-1.db.astra.datastax.com:29042:98a2cd7e-fa1b-3950-942e-42af495c4248:
Traceback (most recent call last):
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\cassandra\cluster.py", line 3234, in run_add_or_renew_pool
    new_pool = HostConnection(host, distance, self)
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\cassandra\pool.py", line 406, in __init__
    self._connection = session.cluster.connection_factory(host.endpoint, on_orphaned_stream_released=self.on_orphaned_stream_released)
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\cassandra\cluster.py", line 1670, in connection_factory
    return self.connection_class.factory(endpoint, self.connect_timeout, *args, **kwargs)
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\cassandra\connection.py", line 855, in factory
    raise OperationTimedOut("Timed out creating connection (%s seconds)" % timeout)
cassandra.OperationTimedOut: errors=Timed out creating connection (5 seconds), last_host=None
[2024-06-03 15:06:41,512] 3244 cassandra.cluster - WARNING -Failed to create connection pool for new host e4d5a3c1-e93d-4762-b366-9ba2252f22f5-eu-west-1.db.astra.datastax.com:29042:9e3a5bee-3d95-3bf7-90f5-09bd2177324b:
Traceback (most recent call last):
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\cassandra\cluster.py", line 3234, in run_add_or_renew_pool
    new_pool = HostConnection(host, distance, self)
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\cassandra\pool.py", line 406, in __init__
    self._connection = session.cluster.connection_factory(host.endpoint, on_orphaned_stream_released=self.on_orphaned_stream_released)
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\cassandra\cluster.py", line 1670, in connection_factory
    return self.connection_class.factory(endpoint, self.connect_timeout, *args, **kwargs)
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\cassandra\connection.py", line 855, in factory
    raise OperationTimedOut("Timed out creating connection (%s seconds)" % timeout)
cassandra.OperationTimedOut: errors=Timed out creating connection (5 seconds), last_host=None
[2024-06-03 15:06:45,197] 36 root - INFO -artifact-datainjection folder created 
[2024-06-03 15:06:45,209] 45 root - INFO -performed train test split on dataframe
[2024-06-03 15:06:45,210] 46 root - INFO -exited split_data as train test split
[2024-06-03 15:06:45,211] 51 root - INFO -exporting train and test file path
[2024-06-03 15:06:45,218] 56 root - INFO -exported train and test file path
[2024-06-03 15:06:45,218] 26 root - INFO -Data ingestion completed and artifact
[2024-06-03 15:06:45,219] 27 root - INFO -Data ingestion completed and artifact: DataIngestionArtifact(trained_file_path='artifact\\06_03_2024_15_06_10\\data_ingestion\\ingested\\train.csv')
[2024-06-03 15:06:45,374] 25 root - INFO -Required number of columns: 5
[2024-06-03 15:06:45,374] 26 root - INFO -Data frame has columns: 5
[2024-06-03 15:06:45,375] 45 root - INFO -Missing numerical columns: [[]]
[2024-06-03 15:06:45,375] 133 root - INFO -Data validation artifact: DataValidationArtifact(validation_status=True, valid_train_file_path='artifact\\06_03_2024_15_06_10\\data_ingestion\\ingested\\train.csv', invalid_train_file_path=None, invalid_test_file_path=None, drift_report_file_path='artifact\\06_03_2024_15_06_10\\data_validation\\drift_report\\report.yaml')
[2024-06-03 15:06:45,683] 41 root - ERROR -Error occurred python script name [C:\Users\DELL\PycharmProjects\pythonProject5\src\pipeline\training_pipeline.py] line number [63] error message [Error occurred python script name [C:\Users\DELL\PycharmProjects\pythonProject5\src\pipeline\training_pipeline.py] line number [50] error message [Error occurred python script name [C:\Users\DELL\PycharmProjects\pythonProject5\src\components\data_transformation.py] line number [136] error message ['DateTime']]]
Traceback (most recent call last):
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\pandas\core\indexes\base.py", line 3361, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 76, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 108, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 5198, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 5206, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\DELL\PycharmProjects\pythonProject5\src\components\data_transformation.py", line 136, in initiate_data_transformation
    result_df33['NumericTimestamp1'] = result_df33['DateTime'].apply(lambda x: datetime.strptime(x, date_format).timestamp())
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\pandas\core\frame.py", line 3458, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\pandas\core\indexes\base.py", line 3363, in get_loc
    raise KeyError(key) from err
KeyError: 'DateTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\DELL\PycharmProjects\pythonProject5\src\pipeline\training_pipeline.py", line 50, in start_data_transformation
    data_transformation_artifact =  data_transformation.initiate_data_transformation()
  File "C:\Users\DELL\PycharmProjects\pythonProject5\src\components\data_transformation.py", line 219, in initiate_data_transformation
    raise SensorException(e, sys) from e
src.exception.SensorException: Error occurred python script name [C:\Users\DELL\PycharmProjects\pythonProject5\src\components\data_transformation.py] line number [136] error message ['DateTime']

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\DELL\PycharmProjects\pythonProject5\src\pipeline\training_pipeline.py", line 63, in run_pipeline
    data_validation_artifact=data_validation_artifact)
  File "C:\Users\DELL\PycharmProjects\pythonProject5\src\pipeline\training_pipeline.py", line 53, in start_data_transformation
    raise  SensorException(e,sys)
src.exception.SensorException: Error occurred python script name [C:\Users\DELL\PycharmProjects\pythonProject5\src\pipeline\training_pipeline.py] line number [50] error message [Error occurred python script name [C:\Users\DELL\PycharmProjects\pythonProject5\src\components\data_transformation.py] line number [136] error message ['DateTime']]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "main.py", line 37, in trainRouteClient
    train_pipeline.run_pipeline()
  File "C:\Users\DELL\PycharmProjects\pythonProject5\src\pipeline\training_pipeline.py", line 66, in run_pipeline
    raise SensorException(e, sys)
src.exception.SensorException: Error occurred python script name [C:\Users\DELL\PycharmProjects\pythonProject5\src\pipeline\training_pipeline.py] line number [63] error message [Error occurred python script name [C:\Users\DELL\PycharmProjects\pythonProject5\src\pipeline\training_pipeline.py] line number [50] error message [Error occurred python script name [C:\Users\DELL\PycharmProjects\pythonProject5\src\components\data_transformation.py] line number [136] error message ['DateTime']]]
[2024-06-03 15:06:45,711] 1745 main - ERROR -Exception on /train [GET]
Traceback (most recent call last):
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\flask\app.py", line 2529, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\flask\app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\flask_cors\extension.py", line 178, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\flask\app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\flask\app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\flask_cors\decorator.py", line 130, in wrapped_function
    resp = make_response(f(*args, **kwargs))
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\flask\helpers.py", line 209, in make_response
    return current_app.make_response(args)  # type: ignore
  File "C:\Users\DELL\anaconda3\envs\pythonProject5\lib\site-packages\flask\app.py", line 2139, in make_response
    f"The view function for {request.endpoint!r} did not"
TypeError: The view function for 'trainRouteClient' did not return a valid response. The function either returned None or ended without a return statement.
[2024-06-03 15:17:01,955] 212 apscheduler.scheduler - INFO -Scheduler has been shut down
